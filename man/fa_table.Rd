% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilityFuncs.R
\name{fa_table}
\alias{fa_table}
\title{Create formatted GT tables for factor analysis results}
\usage{
fa_table(
  x,
  varlabels = NULL,
  title = "Factor analysis results",
  diffuse = 0.1,
  small = 0.3,
  cross = 0.2,
  sort = TRUE
)
}
\arguments{
\item{x}{An object returned by \code{psych::fa()} (i.e., a factor analysis fit
from the \strong{psych} package). Must contain \code{loadings}, \code{communality},
\code{uniquenesses}, \code{complexity}, \code{Vaccounted}, and (for \(>1\) factors) \code{Phi}.}

\item{varlabels}{Optional character vector of length equal to the number of
rows in \code{x$loadings}. Used as human-readable indicator names (row labels).
If \code{sort = TRUE}, labels are re-ordered to match the sorted loadings.}

\item{title}{Character string used as the title of the indicator table.
Default is \code{"Factor analysis results"}.}

\item{diffuse}{Numeric tolerance in [0, 1] for determining \emph{non-assignable}
indicators (items with unclear loadings). If the absolute difference
between the two highest absolute loadings on an item is \emph{less than}
\code{diffuse}, the item is marked as non-assignable (row highlighted). Default
is \code{0.10}.}

\item{small}{Numeric threshold in [0, 1] below which absolute factor
loadings are styled grey and italic to indicate small magnitude. Default
is \code{0.30}.}

\item{cross}{Numeric threshold in [0, 1] above which \emph{secondary} (off-factor)
loadings are styled italic to indicate cross-loadings. Default is \code{0.20}.}

\item{sort}{Logical; if \code{TRUE} (default), the loadings are sorted using
\code{psych::fa.sort()} and \code{varlabels} are re-ordered accordingly.}
}
\value{
A named list with two \code{gt_tbl} objects:
\itemize{
\item \code{ind_table}: GT table of indicators (rows) by factors (columns), plus
\code{Communality}, \code{Uniqueness}, and \code{Complexity}.
\item \code{f_table}: GT table of eigenvalues/variance explained and, if applicable,
factor correlations.
}
}
\description{
Given a fitted factor model from \strong{psych} (\code{psych::fa()}), this function
builds two nicely formatted \href{https://gt.rstudio.com/}{\code{gt}} tables:
\enumerate{
\item \strong{Indicator table} (\code{ind_table}): item (indicator) loadings per factor,
with communalities, uniquenesses, and complexity. Small loadings are
grey/italic; cross-loadings are italic; non-assignable indicators (unclear
loadings) are highlighted.
\item \strong{Factor summary table} (\code{f_table}): eigenvalues and variance explained
(from \code{x[["Vaccounted"]]}), and—when there are multiple factors—the factor
correlation matrix \code{Phi}.
}
}
\details{
Factor columns are auto-named as \code{"Factor_1"}, \code{"Factor_2"}, … in the
returned tables. Styling rules applied to the indicator table:
\itemize{
\item \strong{Small loadings}: \code{abs(loading) < small} → grey + italic text.
\item \strong{Cross-loadings} (when \code{n_factors > 1}): \code{abs(loading) > cross} on any
non-primary factor for that item → italic text.
\item \strong{Non-assignable items}: if the gap between the two largest absolute
loadings is \verb{< diffuse} → row filled red (indicates unclear factor
assignment).
}

The factor summary table stacks \code{Vaccounted} (eigenvalues and variance
explained) and, if available, \code{Phi} (factor correlations), with values
rounded for readability.
}
\section{Warnings}{

If \code{varlabels} is supplied but its length differs from \code{nrow(x$loadings)},
a warning is issued and labels are not applied.
}

\examples{
\dontrun{
  library(psych)
  set.seed(1)
  # Toy data with 3 factors
  X <- simulatePolychoric(300, 3, 5)$data
  fa_fit <- fa(X, nfactors = 3, rotate = "oblimin")

  # Optional labels
  labs <- paste("Item", seq_len(nrow(fa_fit$loadings)))

  out <- fa_table(
    x = fa_fit,
    varlabels = labs,
    title = "EFA results (oblimin)",
    diffuse = 0.10,
    small   = 0.30,
    cross   = 0.20,
    sort    = TRUE
  )

  # Print the GT tables
  out$ind_table
  out$f_table
}

}
\seealso{
\code{\link[psych:fa]{psych::fa()}}, \code{\link[psych:fa.sort]{psych::fa.sort()}}, \code{\link[gt:gt]{gt::gt()}}
}
