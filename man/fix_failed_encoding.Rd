% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilityFuncs.R
\name{fix_failed_encoding}
\alias{fix_failed_encoding}
\title{Repair likely mojibake in character columns (UTF-8 mis-decoded as Latin-1/CP1252)}
\usage{
fix_failed_encoding(
  data,
  cols = NULL,
  from = c("latin1", "Windows-1252"),
  patterns = c("Ã.", "Â.", "â€™", "â€œ", "â€\\u009d", "â€“",
    "â€”", "â€¦", "Ã¥", "Ã¸", "Ã¦", "Ã…", "Ã˜", "Ã†"),
  quiet = FALSE,
  report = c("unique", "columns", "both", "none"),
  max_unique = 50
)
}
\arguments{
\item{data}{A data.frame (or tibble).}

\item{cols}{Optional tidyselect-style specification of columns to check. If
\code{NULL} (default), all character columns are checked.}

\item{from}{Candidate single-byte encodings to try for the byte round-trip.
Defaults to \code{c("latin1", "Windows-1252")}.}

\item{patterns}{Regex patterns treated as signals of mojibake.}

\item{quiet}{If \code{TRUE}, suppress console reporting.}

\item{report}{Character string controlling console output:
\itemize{
\item \code{"unique"} (default): unique before->after changes with counts (global).
\item \code{"columns"}: per-column counts only.
\item \code{"both"}: both reports.
\item \code{"none"}: no output (same as \code{quiet = TRUE}).
}}

\item{max_unique}{Maximum number of unique change rows to print (most frequent first).}
}
\value{
A data.frame of the same class as \code{data} with repaired character columns.
}
\description{
Fixes common mojibake such as \code{"Helse FÃ¸rde"} (should be \code{"Helse Førde"})
caused by UTF-8 bytes being interpreted as Latin-1 / Windows-1252 at import.

The repair is performed using a byte-preserving round-trip equivalent to:
\code{(encode as latin1/cp1252 bytes) -> (decode those bytes as UTF-8)}.

The function returns a modified copy of \code{data}, suitable for piping, and
prints a console report. By default, the report is a summary of UNIQUE changes
(before -> after) with the number of instances across the whole data frame.
}
\examples{
df <- data.frame(
  org  = c("Helse FÃ¸rde", "Helse Vest", NA),
  note = c("smÃ¥", "OK", "Ã…lesund"),
  stringsAsFactors = FALSE
)
fix_failed_encoding(df)

}
